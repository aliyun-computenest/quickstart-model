<div style="background: linear-gradient(135deg, #2563eb, #1e40af); padding: 24px; border-radius: 8px; color: white; text-align: center; margin-bottom: 24px;">
  <h2 style="margin: 0; color: white;">🎬 Tongyi Wanxiang 2.2 - Image-to-Video - A14B</h2>
  <p style="margin: 8px 0 0 0; opacity: 0.9;">Open and Advanced Large-Scale Video Generation Model - Image-to-Video Professional Edition</p>
  <div style="margin-top: 20px;">
    <span style="background: rgba(255,255,255,0.2); color: white; padding: 4px 12px; border-radius: 12px; font-size: 14px; margin: 0 8px;">🧠 27B Parameters MoE</span>
    <span style="background: rgba(255,255,255,0.2); color: white; padding: 4px 12px; border-radius: 12px; font-size: 14px; margin: 0 8px;">🎯 480P & 720P</span>
    <span style="background: rgba(255,255,255,0.2); color: white; padding: 4px 12px; border-radius: 12px; font-size: 14px; margin: 0 8px;">⚡ Cinematic Aesthetics</span>
  </div>
</div>

## 📋 Model Overview

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px; margin: 16px 0;">

**Tongyi Wanxiang 2.2 Image-to-Video A14B** is a revolutionary image-to-video generation model based on Mixture of Experts (MoE) architecture. Compared to the previous Wan2.1, this model achieves comprehensive upgrades in data scale, architectural design, and generation quality, supporting dual-resolution output at 480P and 720P with cinematic-grade aesthetic quality and more stable video synthesis capabilities.

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin: 16px 0;">
  <div style="background: #eff6ff; border-left: 4px solid #2563eb; padding: 16px; border-radius: 4px;">
    <strong>🏷️ Model Identifier</strong><br>
    <div style="margin-top: 8px;">
      <span style="background: #2563eb; color: white; padding: 4px 12px; border-radius: 6px; font-size: 12px; margin-right: 8px;">Wan-AI/Wan2.2-I2V-A14B</span>
    </div>
  </div>

  <div style="background: #f0fdf4; border-left: 4px solid #059669; padding: 16px; border-radius: 4px;">
    <strong>📊 Architecture Scale</strong><br>
    <div style="margin-top: 8px;">
      <span style="background: #059669; color: white; padding: 4px 12px; border-radius: 6px; font-size: 12px; margin-right: 8px;">27B Total Parameters</span>
      <span style="background: #16a34a; color: white; padding: 4px 12px; border-radius: 6px; font-size: 12px;">14B Activated</span>
    </div>
  </div>

  <div style="background: #fef3c7; border-left: 4px solid #d97706; padding: 16px; border-radius: 4px;">
    <strong>🎯 Core Functions</strong><br>
    <div style="margin-top: 8px;">
      <span style="background: #d97706; color: white; padding: 4px 12px; border-radius: 6px; font-size: 12px; margin-right: 8px;">Image-to-Video</span>
      <span style="background: #ea580c; color: white; padding: 4px 12px; border-radius: 6px; font-size: 12px;">Dual Resolution</span>
    </div>
  </div>
</div>

</div>

## 🚀 Core Technical Breakthroughs

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; margin: 16px 0;">

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
<h3 style="margin-top: 0; color: #1e40af;">🧠 MoE Mixture of Experts Architecture</h3>
<ul style="margin: 0; padding-left: 20px;">
  <li><strong>Dual Expert Design</strong>: High-noise expert + Low-noise expert</li>
  <li><strong>Intelligent Switching</strong>: Automatic switching based on Signal-to-Noise Ratio (SNR)</li>
  <li><strong>Efficient Inference</strong>: 27B parameters, 14B activated, same cost</li>
  <li><strong>Optimized Denoising</strong>: Specifically optimized for diffusion models</li>
</ul>
</div>

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
<h3 style="margin-top: 0; color: #1e40af;">🎬 Cinematic-Grade Aesthetic Quality</h3>
<ul style="margin: 0; padding-left: 20px;">
  <li><strong>Fine-grained Labels</strong>: Lighting, composition, contrast, tone</li>
  <li><strong>Controllable Generation</strong>: Precise cinematic style control</li>
  <li><strong>Aesthetic Preferences</strong>: Customizable visual styles</li>
  <li><strong>Professional Quality</strong>: Commercial-grade video output</li>
</ul>
</div>

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
<h3 style="margin-top: 0; color: #1e40af;">📈 Large-Scale Data Training</h3>
<ul style="margin: 0; padding-left: 20px;">
  <li><strong>Data Expansion</strong>: Images +65.6%, Videos +83.2%</li>
  <li><strong>Multi-dimensional Enhancement</strong>: Motion, semantics, aesthetics all improved</li>
  <li><strong>Top Performance</strong>: Leading among open-source and closed-source models</li>
  <li><strong>Generalization Ability</strong>: Significantly improved adaptability</li>
</ul>
</div>

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
<h3 style="margin-top: 0; color: #1e40af;">⚡ Efficient Deployment Optimization</h3>
<ul style="margin: 0; padding-left: 20px;">
  <li><strong>Consumer GPUs</strong>: Supports RTX 4090 and similar cards</li>
  <li><strong>Multi-resolution</strong>: 480P & 720P dual support</li>
  <li><strong>Stable Synthesis</strong>: Reduced unrealistic camera movements</li>
  <li><strong>Style Diversity</strong>: Enhanced scene adaptability</li>
</ul>
</div>

</div>

## 🔧 Technical Specifications Comparison

<div style="overflow-x: auto; margin: 16px 0;">
<table style="width: 100%; border-collapse: collapse; background: white; border-radius: 6px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
  <thead style="background: #f8fafc;">
    <tr>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; color: #1e40af; font-weight: 600;">Specification</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; color: #1e40af; font-weight: 600;">Wan2.1-I2V-14B</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; color: #1e40af; font-weight: 600;">Wan2.2-I2V-A14B</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; color: #1e40af; font-weight: 600;">Improvement</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-weight: 500;">Architecture Type</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Traditional Diffusion Model</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">MoE Mixture of Experts</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><span style="background: #dcfce7; color: #059669; padding: 2px 8px; border-radius: 4px; font-size: 12px;">Architecture Upgrade</span></td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-weight: 500;">Parameter Scale</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">14B</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">27B (14B activated)</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><span style="background: #dcfce7; color: #059669; padding: 2px 8px; border-radius: 4px; font-size: 12px;">+93%</span></td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-weight: 500;">Supported Resolution</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">480P</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">480P & 720P</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><span style="background: #dcfce7; color: #059669; padding: 2px 8px; border-radius: 4px; font-size: 12px;">Dual Resolution</span></td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-weight: 500;">Training Data</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Base Dataset</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Images +65.6%, Videos +83.2%</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><span style="background: #dcfce7; color: #059669; padding: 2px 8px; border-radius: 4px; font-size: 12px;">Massive Expansion</span></td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-weight: 500;">Aesthetic Quality</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Standard Quality</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Cinematic Aesthetics</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><span style="background: #dcfce7; color: #059669; padding: 2px 8px; border-radius: 4px; font-size: 12px;">Quality Leap</span></td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-weight: 500;">Motion Stability</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Basic Stability</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Significantly Enhanced</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><span style="background: #dcfce7; color: #059669; padding: 2px 8px; border-radius: 4px; font-size: 12px;">Stability Improvement</span></td>
    </tr>
    <tr>
      <td style="padding: 12px; font-weight: 500;">Integration Ecosystem</td>
      <td style="padding: 12px;">ComfyUI</td>
      <td style="padding: 12px;">ComfyUI + Diffusers + ModelScope</td>
      <td style="padding: 12px;"><span style="background: #dcfce7; color: #059669; padding: 2px 8px; border-radius: 4px; font-size: 12px;">Ecosystem Enhancement</span></td>
    </tr>
  </tbody>
</table>
</div>

## 💻 System Requirements

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px; margin: 16px 0;">

### 🖥️ Recommended Hardware Configuration

<div style="overflow-x: auto; margin: 16px 0;">
<table style="width: 100%; border-collapse: collapse; background: white; border-radius: 6px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
  <thead style="background: #f8fafc;">
    <tr>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">Component</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">Recommended Specs</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>CPU</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">16 vCPU</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">High-performance multi-core processor</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>Memory</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">60 GiB</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Large capacity system memory</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>GPU</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">1 × NVIDIA A10</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Professional GPU with 80GB+ VRAM</td>
    </tr>
  </tbody>
</table>
</div>

</div>

## 🎯 Usage Guide

# 🌐 ComfyUI Integration Usage Guide

## 📍 ComfyUI Web UI Tutorial

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px; margin: 16px 0;">

### 🚀 Step 1: Access Interface

<div style="background: #eff6ff; border-left: 4px solid #2563eb; padding: 16px; margin: 16px 0; border-radius: 4px;">
  <strong>🔗 Interface Access</strong><br>
  Click the access link at the service instance to enter the ComfyUI visual interface
</div>

![img_3.png](img_3.png)
### 🔧 Step 2: Select Workflow

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 16px 0;">

<p style="margin: 0; color: #065f46;">Select the <code>official workflow in the top left</code> and open it</p>

</div>

<div style="background: #fff7ed; border-left: 4px solid #ea580c; padding: 16px; border-radius: 4px;">

![img_4.png](img_4.png)

![img_3.png](img_3.png)
</div>

### 📤 Step 3: Upload Image

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; margin: 16px 0;">

**In the LoadImage node:**
- Select sample images for testing
- Or upload custom images from your computer
- Supports JPEG, PNG, WebP and other formats
</div>

### ✍️ Step 4: Set Text Description

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 16px 0;">

<div style="background: #f0fdf4; border-left: 4px solid #059669; padding: 16px; border-radius: 4px;">
<h4 style="color: #059669; margin: 0 0 8px 0;">✅ Positive Prompt</h4>
<p style="margin: 0 0 8px 0; color: #065f46;">Fill in the <strong>TextEncode (Positive)</strong> node:</p>
<div style="background: #f8fafc; padding: 8px; border-radius: 4px; font-family: monospace; font-size: 12px;">
"Cinematic lighting, graceful movements, smooth animation, high quality"
</div>
</div>

<div style="background: #fff7ed; border-left: 4px solid #ea580c; padding: 16px; border-radius: 4px;">
<h4 style="color: #ea580c; margin: 0 0 8px 0;">❌ Negative Prompt</h4>
<p style="margin: 0 0 8px 0; color: #9a3412;">Fill in the <strong>TextEncode (Negative)</strong> node:</p>
<div style="background: #f8fafc; padding: 8px; border-radius: 4px; font-family: monospace; font-size: 12px;">
"bad quality, blurry, distorted, static"
</div>
</div>

</div>

### ⚙️ Step 5: Configure Parameters

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; margin: 16px 0;">

**In the WanVideoImageClipEncode node settings:**

<div style="overflow-x: auto; margin: 16px 0;">
<table style="width: 100%; border-collapse: collapse; background: white; border-radius: 6px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
  <thead style="background: #f8fafc;">
    <tr>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">Parameter Name</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">Recommended Value</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>generation_width</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">1280 (720P) / 854 (480P)</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Video width</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>generation_height</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">720 (720P) / 480 (480P)</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Video height</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>num_frames</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">81</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Number of video frames</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>noise_aug_strength</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">0</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Noise augmentation strength</td>
    </tr>
    <tr>
      <td style="padding: 12px; font-weight: 500;"><strong>adjust_resolution</strong></td>
      <td style="padding: 12px;">True</td>
      <td style="padding: 12px;">Automatically adjust resolution</td>
    </tr>
  </tbody>
</table>
</div>

</div>

### 🎬 Step 6: Execute Workflow

<div style="background: #eff6ff; border-left: 4px solid #2563eb; padding: 16px; margin: 16px 0; border-radius: 4px;">
  <strong>🚀 Start Generation</strong><br>
  Click the <strong>"Queue Prompt"</strong> button in the right panel to start video generation<br>
  Real-time status can be viewed in the progress bar during generation
</div>

</div>

## 🔌 ComfyUI API Calling Method

### 🔑 Get Authentication Information

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 16px 0;">

<div style="background: #fff7ed; border-left: 4px solid #ea580c; padding: 16px; border-radius: 4px;">
<h4 style="color: #ea580c; margin: 0 0 8px 0;">🔐 Get Token</h4>
<p style="margin: 0 0 12px 0;">Click the settings button in the top right, open the bottom panel to get API Token</p>
<div style="text-align: center; padding: 12px; background: #f8fafc; border-radius: 6px;">
  <div style="background: #fed7aa; color: #ea580c; padding: 8px 16px; border-radius: 6px; display: inline-block;">
    🔑 API Token Interface

![img_1.png](img_1.png)
  </div>
</div>
</div>

<div style="background: #eff6ff; border-left: 4px solid #2563eb; padding: 16px; border-radius: 4px;">
<h4 style="color: #2563eb; margin: 0 0 8px 0;">🌐 Get Server Address</h4>
<p style="margin: 0 0 12px 0;">Get COMFYUI_SERVER address from service instance information</p>
<div style="text-align: center; padding: 12px; background: #f8fafc; border-radius: 6px;">
  <div style="background: #dbeafe; color: #2563eb; padding: 8px 16px; border-radius: 6px; display: inline-block;">
    🌐 Server Address Configuration

![img_2.png](img_2.png)
  </div>
</div>
</div>

</div>

### 💻 Python API Call Example

<details style="border: 2px solid #2563eb; border-radius: 12px; padding: 20px; margin: 20px 0; background: linear-gradient(145deg, #f8fafc, #eff6ff); box-shadow: 0 8px 16px rgba(37, 99, 235, 0.15);">
<summary style="font-weight: bold; font-size: 18px; color: white; cursor: pointer; padding: 16px; background: linear-gradient(135deg, #2563eb, #1e40af); border-radius: 8px; margin: -20px -20px 20px -20px; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); transition: all 0.3s ease; display: flex; align-items: center; box-shadow: 0 4px 8px rgba(37, 99, 235, 0.3);">
🐍 Click to expand complete Python API call code
</summary>

```python
import requests, json, uuid, time, random, os

# 🔧 配置参数 - Wan2.2 14B 图生视频专用
COMFYUI_SERVER = "127.0.0.1:8188"  # 本地服务器
COMFYUI_TOKEN = ""  # 本地通常不需要token
UNET_HIGH_NOISE_MODEL = "wan2.2_i2v_high_noise_14B_fp8_scaled.safetensors"
UNET_LOW_NOISE_MODEL = "wan2.2_i2v_low_noise_14B_fp8_scaled.safetensors"
CLIP_MODEL = "umt5_xxl_fp8_e4m3fn_scaled.safetensors"
VAE_MODEL = "wan_2.1_vae.safetensors"

# 🎯 预设参数
IMAGE_PATH = "input_image.jpg"
PROMPT = "The white dragon warrior stands still, eyes full of determination and strength. The camera slowly moves closer or circles around the warrior, highlighting the powerful presence and heroic spirit of the character."
NEG_PROMPT = "色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走"

class ComfyUIWan22_14B_I2VClient:
    def __init__(self, server=COMFYUI_SERVER, token=COMFYUI_TOKEN):
        self.base_url = f"http://{server}"
        self.token = token
        self.client_id = str(uuid.uuid4())
        self.headers = {"Content-Type": "application/json"}
        if token:
            self.headers["Authorization"] = f"Bearer {token}"

    def upload_image(self, image_path):
        """📤 上传图片到ComfyUI"""
        if not os.path.exists(image_path):
            raise Exception(f"图片文件不存在: {image_path}")

        try:
            with open(image_path, 'rb') as f:
                files = {'image': (os.path.basename(image_path), f, 'image/png')}
                headers = {}
                if self.token:
                    headers["Authorization"] = f"Bearer {self.token}"

                response = requests.post(f"{self.base_url}/upload/image", files=files, headers=headers)
                print(f"Upload response: {response.text}")

                if response.status_code != 200:
                    raise Exception(f"上传失败，状态码: {response.status_code}")

                result = response.json()
                if 'name' not in result:
                    raise Exception(f"上传响应中没有文件名: {result}")

                return result['name']
        except Exception as e:
            raise Exception(f"图片上传失败: {e}")

    def generate_wan22_14b_i2v(self, image_path, prompt, neg_prompt, steps=20, cfg=3.5, width=1280, height=704, frames=81, fps=16):
        """🎬 Wan2.2 14B 图生视频生成 - 双阶段采样"""
        print("📤 正在上传图片...")
        image_name = self.upload_image(image_path)
        print(f"✅ 图片上传成功: {image_name}")

        print("🎬 开始 Wan2.2 14B 图生视频任务...")

        # 完全基于你提供的图生视频 JSON 工作流
        workflow = {
            "6": {
                "inputs": {
                    "text": prompt,
                    "clip": ["38", 0]
                },
                "class_type": "CLIPTextEncode",
                "_meta": {"title": "CLIP Text Encode (Positive Prompt)"}
            },
            "7": {
                "inputs": {
                    "text": neg_prompt,
                    "clip": ["38", 0]
                },
                "class_type": "CLIPTextEncode",
                "_meta": {"title": "CLIP Text Encode (Negative Prompt)"}
            },
            "8": {
                "inputs": {
                    "samples": ["58", 0],
                    "vae": ["39", 0]
                },
                "class_type": "VAEDecode",
                "_meta": {"title": "VAE解码"}
            },
            "37": {
                "inputs": {
                    "unet_name": UNET_HIGH_NOISE_MODEL,
                    "weight_dtype": "default"
                },
                "class_type": "UNETLoader",
                "_meta": {"title": "UNet加载器"}
            },
            "38": {
                "inputs": {
                    "clip_name": CLIP_MODEL,
                    "type": "wan",
                    "device": "default"
                },
                "class_type": "CLIPLoader",
                "_meta": {"title": "加载CLIP"}
            },
            "39": {
                "inputs": {
                    "vae_name": VAE_MODEL
                },
                "class_type": "VAELoader",
                "_meta": {"title": "加载VAE"}
            },
            "54": {
                "inputs": {
                    "shift": 8.000000000000002,
                    "model": ["37", 0]
                },
                "class_type": "ModelSamplingSD3",
                "_meta": {"title": "采样算法（SD3）"}
            },
            "55": {
                "inputs": {
                    "shift": 8,
                    "model": ["56", 0]
                },
                "class_type": "ModelSamplingSD3",
                "_meta": {"title": "采样算法（SD3）"}
            },
            "56": {
                "inputs": {
                    "unet_name": UNET_LOW_NOISE_MODEL,
                    "weight_dtype": "default"
                },
                "class_type": "UNETLoader",
                "_meta": {"title": "UNet加载器"}
            },
            "57": {
                "inputs": {
                    "add_noise": "enable",
                    "noise_seed": random.randint(1, 1000000000000000),
                    "steps": steps,
                    "cfg": cfg,
                    "sampler_name": "euler",
                    "scheduler": "simple",
                    "start_at_step": 0,
                    "end_at_step": 10,
                    "return_with_leftover_noise": "enable",
                    "model": ["54", 0],
                    "positive": ["63", 0],
                    "negative": ["63", 1],
                    "latent_image": ["63", 2]
                },
                "class_type": "KSamplerAdvanced",
                "_meta": {"title": "K采样器（高级）"}
            },
            "58": {
                "inputs": {
                    "add_noise": "disable",
                    "noise_seed": 0,
                    "steps": steps,
                    "cfg": cfg,
                    "sampler_name": "euler",
                    "scheduler": "simple",
                    "start_at_step": 10,
                    "end_at_step": 10000,
                    "return_with_leftover_noise": "disable",
                    "model": ["55", 0],
                    "positive": ["63", 0],
                    "negative": ["63", 1],
                    "latent_image": ["57", 0]
                },
                "class_type": "KSamplerAdvanced",
                "_meta": {"title": "K采样器（高级）"}
            },
            "60": {
                "inputs": {
                    "fps": fps,
                    "images": ["8", 0]
                },
                "class_type": "CreateVideo",
                "_meta": {"title": "创建视频"}
            },
            "61": {
                "inputs": {
                    "filename_prefix": "video/ComfyUI_I2V_14B",
                    "format": "auto",
                    "codec": "auto",
                    "video": ["60", 0]
                },
                "class_type": "SaveVideo",
                "_meta": {"title": "保存视频"}
            },
            "62": {
                "inputs": {
                    "image": image_name
                },
                "class_type": "LoadImage",
                "_meta": {"title": "加载图像"}
            },
            "63": {
                "inputs": {
                    "width": width,
                    "height": height,
                    "length": frames,
                    "batch_size": 1,
                    "positive": ["6", 0],
                    "negative": ["7", 0],
                    "vae": ["39", 0],
                    "start_image": ["62", 0]
                },
                "class_type": "WanImageToVideo",
                "_meta": {"title": "Wan图像到视频"}
            }
        }

        print("📤 提交 Wan2.2 14B 图生视频双阶段采样工作流...")
        response = requests.post(f"{self.base_url}/prompt", headers=self.headers, json={"prompt": workflow, "client_id": self.client_id})
        print(f"API Response: {response.text}")

        if response.status_code != 200:
            raise Exception(f"API请求失败，状态码: {response.status_code}")

        result = response.json()
        if "error" in result:
            raise Exception(f"Workflow error: {result['error']}")
        if "prompt_id" not in result:
            raise Exception(f"No prompt_id in response: {result}")
        return result["prompt_id"]

    def get_status(self, task_id):
        """📊 获取任务状态"""
        try:
            queue_data = requests.get(f"{self.base_url}/queue", headers=self.headers).json()
            if any(item[1] == task_id for item in queue_data.get("queue_running", [])):
                return "processing"
            if any(item[1] == task_id for item in queue_data.get("queue_pending", [])):
                return "pending"
            history_response = requests.get(f"{self.base_url}/history/{task_id}", headers=self.headers)
            return "completed" if history_response.status_code == 200 and task_id in history_response.json() else "processing"
        except:
            return "processing"

    def download_video(self, task_id, output_path="wan22_14b_i2v_output.mp4"):
        """📥 下载生成的视频"""
        try:
            response = requests.get(f"{self.base_url}/history/{task_id}", headers=self.headers)
            history = response.json()
            if task_id in history:
                for output in history[task_id]['outputs'].values():
                    # 查找视频文件
                    if 'videos' in output:
                        filename = output['videos'][0]['filename']
                        video_response = requests.get(f"{self.base_url}/view?filename={filename}", headers=self.headers)
                        with open(output_path, "wb") as f:
                            f.write(video_response.content)
                        return output_path
                    # 兼容其他可能的输出格式
                    elif 'gifs' in output:
                        filename = output['gifs'][0]['filename']
                        video_response = requests.get(f"{self.base_url}/view?filename={filename}", headers=self.headers)
                        with open(output_path, "wb") as f:
                            f.write(video_response.content)
                        return output_path
        except Exception as e:
            print(f"Download error: {e}")
        return None

def main():
    """🚀 主函数 - 执行 Wan2.2 14B 图生视频任务"""
    client = ComfyUIWan22_14B_I2VClient()
    try:
        print(f"🎬 开始 Wan2.2 14B 图生视频任务...")
        print(f"📷 输入图片: {IMAGE_PATH}")
        print(f"📝 正向提示词: {PROMPT}")
        print(f"🚫 负向提示词: {NEG_PROMPT}")
        print(f"🔧 使用双阶段采样：高噪声I2V模型 + 低噪声I2V模型")

        if not os.path.exists(IMAGE_PATH):
            print(f"❌ 图片文件不存在: {IMAGE_PATH}")
            print("请确保当前目录下有输入图片文件")
            return

        # 14B 图生视频生成
        task_id = client.generate_wan22_14b_i2v(IMAGE_PATH, PROMPT, NEG_PROMPT, 20, 3.5, 1280, 704, 81, 16)
        print(f"🆔 Task ID: {task_id}")

        while True:
            status = client.get_status(task_id)
            print(f"📊 Current status: {status}")
            if status == "completed":
                print("✅ Wan2.2 14B I2V Video ready!");
                break
            elif status == "failed":
                print("❌ Generation failed!");
                exit(1)
            time.sleep(15)  # 14B模型生成时间更长，增加轮询间隔

        output_file = client.download_video(task_id, "wan22_14b_i2v_output.mp4")
        print("🎉 Video downloaded successfully!" if output_file else "❌ Failed to download video")
        if output_file:
            print(f"📁 Saved as: {output_file}")

    except Exception as e:
        print(f"❌ Error: {e}")

if __name__ == "__main__":
    main()

```

</details>

### 🔗 ComfyUI API Endpoint Description

<div style="overflow-x: auto; margin: 16px 0;">
<table style="width: 100%; border-collapse: collapse; background: white; border-radius: 6px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
  <thead style="background: #f8fafc;">
    <tr>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; color: #1e40af; font-weight: 600;">Endpoint</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; color: #1e40af; font-weight: 600;">Method</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; color: #1e40af; font-weight: 600;">Function</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; color: #1e40af; font-weight: 600;">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-family: monospace; background: #f8fafc;">/queue</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">GET</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Get queue status</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">View current task queue and running status</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-family: monospace; background: #f8fafc;">/prompt</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">POST</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Submit workflow</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Execute Wan2.2 Image-to-Video task</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-family: monospace; background: #f8fafc;">/history/{prompt_id}</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">GET</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Get execution history</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">View task execution results and outputs</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9; font-family: monospace; background: #f8fafc;">/upload/image</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">POST</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Upload image</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Upload input image file</td>
    </tr>
    <tr>
      <td style="padding: 12px; font-family: monospace; background: #f8fafc;">/view</td>
      <td style="padding: 12px;">GET</td>
      <td style="padding: 12px;">Download output file</td>
      <td style="padding: 12px;">Get generated result files</td>
    </tr>
  </tbody>
</table>
</div>

## ⚙️ ComfyUI Node Detailed Description

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; margin: 16px 0;">

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
<h3 style="margin-top: 0; color: #1e40af;">📤 Input Nodes</h3>
<ul style="margin: 0; padding-left: 20px;">
  <li><strong>LoadImage</strong>: Load input image</li>
  <li><strong>WanVideoTextEncode</strong>: Text encoder</li>
  <li><strong>WanVideoImageClipEncode</strong>: Image encoder</li>
</ul>
</div>

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
<h3 style="margin-top: 0; color: #1e40af;">🧠 Model Nodes</h3>
<ul style="margin: 0; padding-left: 20px;">
  <li><strong>WanVideoModelLoader</strong>: Wan2.2 model loader</li>
  <li><strong>WanVideoVAELoader</strong>: VAE model loader</li>
  <li><strong>LoadWanVideoT5TextEncoder</strong>: T5 text encoder</li>
</ul>
</div>

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
<h3 style="margin-top: 0; color: #1e40af;">⚡ Processing Nodes</h3>
<ul style="margin: 0; padding-left: 20px;">
  <li><strong>WanVideoSampler</strong>: Video sampler</li>
  <li><strong>WanVideoDecode</strong>: Video decoder</li>
  <li><strong>WanVideoBlockSwap</strong>: Memory optimization</li>
</ul>
</div>

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px;">
<h3 style="margin-top: 0; color: #1e40af;">📤 Output Nodes</h3>
<ul style="margin: 0; padding-left: 20px;">
  <li><strong>VHS_VideoCombine</strong>: Video synthesis output</li>
  <li><strong>PreviewImage</strong>: Image preview</li>
  <li><strong>SaveImage</strong>: Image save</li>
</ul>
</div>

</div>

---

## 📊 Performance Benchmarks

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px; margin: 16px 0;">

### ⚡ Computational Efficiency Comparison

<div style="overflow-x: auto; margin: 16px 0;">
<table style="width: 100%; border-collapse: collapse; background: white; border-radius: 6px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
  <thead style="background: #f8fafc;">
    <tr>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">GPU Model</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">Single GPU</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">4×GPU</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">8×GPU</th>
      <th style="padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;">Optimization Features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>A100 80GB</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Recommended Config</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Efficient Parallel</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Optimal Performance</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">FSDP + Ulysses</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>H100 80GB</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Best Single Card</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Ultra-fast Processing</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Top Performance</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">FlashAttention3</td>
    </tr>
    <tr>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;"><strong>RTX 4090</strong></td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Consumer Choice</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">-</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">-</td>
      <td style="padding: 12px; border-bottom: 1px solid #f1f5f9;">Model Offloading</td>
    </tr>
  </tbody>
</table>
</div>

<div style="background: #f0fdf4; border-left: 4px solid #059669; padding: 16px; margin: 16px 0; border-radius: 4px;">
  <strong>🎯 Performance Advantages</strong><br>
  • MoE Architecture: 27B parameters, 14B activated, same inference cost<br>
  • Built-in FSDP and Ulysses distributed implementation<br>
  • Automatic model parameter type conversion optimization<br>
  • Average performance data after warm-up and multiple sampling
</div>

</div>

## 💡 Prompt Writing Guide

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 16px 0;">

<div style="background: #f0fdf4; border-left: 4px solid #059669; padding: 16px; border-radius: 4px;">
<h4 style="color: #059669; margin: 0 0 8px 0;">✅ Positive Prompt Examples</h4>
<div style="background: #f8fafc; padding: 12px; border-radius: 6px; margin: 8px 0;">
<p style="margin: 0; font-style: italic; color: #065f46; font-size: 14px;">"Summer beach vacation style, a white cat wearing sunglasses sits on a surfboard. The fluffy-furred feline gazes directly at the camera with a relaxed expression."</p>
</div>
<div style="background: #f8fafc; padding: 12px; border-radius: 6px; margin: 8px 0;">
<p style="margin: 0; font-style: italic; color: #065f46; font-size: 14px;">"Cinematic lighting, graceful movements, smooth animation, high quality, professional cinematography"</p>
</div>
</div>

<div style="background: #fff7ed; border-left: 4px solid #ea580c; padding: 16px; border-radius: 4px;">
<h4 style="color: #ea580c; margin: 0 0 8px 0;">❌ Negative Prompt Suggestions</h4>
<div style="background: #f8fafc; padding: 12px; border-radius: 6px; margin: 8px 0;">
<p style="margin: 0; font-style: italic; color: #9a3412; font-size: 14px;">"bad quality video, low quality, blurry, distorted, choppy animation, static, bad anatomy"</p>
</div>
<div style="background: #f8fafc; padding: 12px; border-radius: 6px; margin: 8px 0;">
<p style="margin: 0; font-style: italic; color: #9a3412; font-size: 14px;">"unnatural movement, jerky motion, inconsistent, artifacts, noise"</p>
</div>
</div>

</div>

## 🔗 Integration Ecosystem

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin: 16px 0;">

<div style="background: #eff6ff; border-left: 4px solid #2563eb; padding: 16px; border-radius: 4px;">
  <strong>🎨 ComfyUI</strong><br>
  <div style="margin-top: 8px;">
    <span style="background: #dcfce7; color: #059669; padding: 4px 12px; border-radius: 12px; font-size: 12px; margin-right: 8px;">✅ Integrated</span>
    <span style="background: #dbeafe; color: #2563eb; padding: 4px 12px; border-radius: 12px; font-size: 12px;">EN/CN Docs</span>
  </div>
  <p style="margin: 8px 0 0 0; color: #1e40af; font-size: 14px;">Visual workflow, easy to use</p>
</div>

<div style="background: #f0fdf4; border-left: 4px solid #059669; padding: 16px; border-radius: 4px;">
  <strong>🤗 Diffusers</strong><br>
  <div style="margin-top: 8px;">
    <span style="background: #dcfce7; color: #059669; padding: 4px 12px; border-radius: 12px; font-size: 12px; margin-right: 8px;">✅ Integrated</span>
    <span style="background: #dbeafe; color: #2563eb; padding: 4px 12px; border-radius: 12px; font-size: 12px;">I2V-A14B</span>
  </div>
  <p style="margin: 8px 0 0 0; color: #065f46; font-size: 14px;">Standardized API interface</p>
</div>

<div style="background: #fef3c7; border-left: 4px solid #d97706; padding: 16px; border-radius: 4px;">
  <strong>🤖 ModelScope</strong><br>
  <div style="margin-top: 8px;">
    <span style="background: #dcfce7; color: #059669; padding: 4px 12px; border-radius: 12px; font-size: 12px; margin-right: 8px;">✅ Official Support</span>
    <span style="background: #dbeafe; color: #2563eb; padding: 4px 12px; border-radius: 12px; font-size: 12px;">Native Integration</span>
  </div>
  <p style="margin: 8px 0 0 0; color: #9a3412; font-size: 14px;">Model hosting and distribution</p>
</div>

<div style="background: #f3e8ff; border-left: 4px solid #7c3aed; padding: 16px; border-radius: 4px;">
  <strong>🐙 GitHub</strong><br>
  <div style="margin-top: 8px;">
    <span style="background: #dcfce7; color: #059669; padding: 4px 12px; border-radius: 12px; font-size: 12px; margin-right: 8px;">✅ Open Source</span>
    <span style="background: #dbeafe; color: #2563eb; padding: 4px 12px; border-radius: 12px; font-size: 12px;">Complete Code</span>
  </div>
  <p style="margin: 8px 0 0 0; color: #5b21b6; font-size: 14px;">Open source, community-driven</p>
</div>

</div>

## 🎯 Application Scenarios

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; margin: 16px 0;">

<div style="background: #eff6ff; border-left: 4px solid #2563eb; padding: 16px; border-radius: 4px; text-align: center;">
<div style="font-size: 2.5em; margin-bottom: 12px; color: #2563eb;">🎬</div>
<h4 style="margin: 0 0 8px 0; color: #1e40af;">Film Production</h4>
<p style="margin: 0; color: #1e40af;">Cinematic-grade aesthetic quality, professional video production</p>
</div>

<div style="background: #f0fdf4; border-left: 4px solid #059669; padding: 16px; border-radius: 4px; text-align: center;">
<div style="font-size: 2.5em; margin-bottom: 12px; color: #059669;">🛍️</div>
<h4 style="margin: 0 0 8px 0; color: #059669;">Commercial Marketing</h4>
<p style="margin: 0; color: #065f46;">Product showcase animations, marketing video production</p>
</div>

<div style="background: #fff7ed; border-left: 4px solid #ea580c; padding: 16px; border-radius: 4px; text-align: center;">
<div style="font-size: 2.5em; margin-bottom: 12px; color: #ea580c;">🎨</div>
<h4 style="margin: 0 0 8px 0; color: #ea580c;">Artistic Creation</h4>
<p style="margin: 0; color: #9a3412;">Digital art animation, creative video generation</p>
</div>

<div style="background: #f5f3ff; border-left: 4px solid #7c3aed; padding: 16px; border-radius: 4px; text-align: center;">
<div style="font-size: 2.5em; margin-bottom: 12px; color: #7c3aed;">📱</div>
<h4 style="margin: 0 0 8px 0; color: #7c3aed;">Social Media</h4>
<p style="margin: 0; color: #5b21b6;">Short video production, social content creation</p>
</div>

</div>

## 📄 License and Citation

<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px; margin: 16px 0;">

### 📋 Open Source License

<div style="background: #f0fdf4; border-left: 4px solid #059669; padding: 16px; margin: 16px 0; border-radius: 4px;">
  <strong>📜 Apache 2.0 License</strong><br>
  • Free to use and distribute<br>
  • Commercial-friendly open source license<br>
  • Complete usage rights granted<br>
  • Must comply with relevant laws and regulations
</div>

### 📚 Academic Citation

```bibtex
@article{wan2025,
      title={Wan: Open and Advanced Large-Scale Video Generative Models}, 
      author={Team Wan and Ang Wang and Baole Ai and Bin Wen and Chaojie Mao and Chen-Wei Xie and Di Chen and Feiwu Yu and Haiming Zhao and Jianxiao Yang and Jianyuan Zeng and Jiayu Wang and Jingfeng Zhang and Jingren Zhou and Jinkai Wang and Jixuan Chen and Kai Zhu and Kang Zhao and Keyu Yan and Lianghua Huang and Mengyang Feng and Ningyi Zhang and Pandeng Li and Pingyu Wu and Ruihang Chu and Ruili Feng and Shiwei Zhang and Siyang Sun and Tao Fang and Tianxing Wang and Tianyi Gui and Tingyu Weng and Tong Shen and Wei Lin and Wei Wang and Wei Wang and Wenmeng Zhou and Wente Wang and Wenting Shen and Wenyuan Yu and Xianzhong Shi and Xiaoming Huang and Xin Xu and Yan Kou and Yangyu Lv and Yifei Li and Yijing Liu and Yiming Wang and Yingya Zhang and Yitong Huang and Yong Li and You Wu and Yu Liu and Yulin Pan and Yun Zheng and Yuntao Hong and Yupeng Shi and Yutong Feng and Zeyinzi Jiang and Zhen Han and Zhi-Fan Wu and Ziyu Liu},
      journal = {arXiv preprint arXiv:2503.20314},
      year={2025}
}
```

</div>


<div style="text-align: center; padding: 16px; background: #f8fafc; border-radius: 6px; margin-top: 24px;">
  <p style="margin: 0; color: #64748b; font-size: 14px;">
    🎬 <strong>Tongyi Wanxiang 2.2 Image-to-Video A14B</strong> | Open and Advanced Large-Scale Video Generation Model
  </p>
  <p style="margin: 4px 0 0 0; color: #94a3b8; font-size: 12px;">
    © 2025 Tongyi Wanxiang Team | Apache 2.0 Open Source License | Turn Every Image into Amazing Video
  </p>
</div>